# üîç –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ API –∏ –∫–∞—Ä—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ excludeIds –±–µ–∑ –ª–∏–º–∏—Ç–∞

## üìù –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- ‚úÖ **excludeIds –±–µ–∑ –ª–∏–º–∏—Ç–∞** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∫–µ—à–∞ (–±—ã–ª–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1000)
- ‚úÖ **SQL –∑–∞–ø—Ä–æ—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `NOT (id = ANY(...))` –≤–º–µ—Å—Ç–æ `!= ALL()` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ **AbortController —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** - –æ—Ç–º–µ–Ω–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã
- ‚úÖ **–£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ –ª–æ–≥–∏** - –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚úÖ **–£–±—Ä–∞–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - —É–¥–∞–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `isBoundsTooLarge`

### ‚ö†Ô∏è –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
- üî¥ **LIMIT –≤ SQL** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã
- üî¥ **–í–∞–ª–∏–¥–∞—Ü–∏—è bounds** - —Ä–∞–∑–º–µ—Ä –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- üî¥ **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ

### 1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (API, Services, Repository)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ EverShop middleware —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ PostGIS –¥–ª—è –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- ‚úÖ TypeScript —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: `pointData` –∏ `excludeIds` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

### 2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)**
- ‚úÖ **pointData**: –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–∫–∏ –≤ calculate –∑–∞–ø—Ä–æ—Å–µ (—É–±–∏—Ä–∞–µ—Ç 1 –∑–∞–ø—Ä–æ—Å –∫ –ë–î)
- ‚úÖ **excludeIds**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ (—ç–∫–æ–Ω–æ–º–∏—è 70-90% —Ç—Ä–∞—Ñ–∏–∫–∞)
  - ‚úÖ –ë–µ–∑ –ª–∏–º–∏—Ç–∞ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ID (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∫–µ—à–∞)
  - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `NOT (id = ANY(...))` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏
- ‚úÖ **POST –≤–º–µ—Å—Ç–æ GET**: –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–º–µ—Ä excludeIds
- ‚úÖ **Debounce**: 500ms –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã
- ‚úÖ **–ö–µ—à –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ**: `pointsCache` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **Ref –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ `pointsCacheRef`
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Ä–∞–±–æ—Ç—ã excludeIds

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- ‚úÖ Try-catch –±–ª–æ–∫–∏ –≤–æ –≤—Å–µ—Ö endpoints
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (502, 503) –≤ calculate
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã (400, 404, 500)

### 4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î**
- ‚úÖ PostGIS –∏–Ω–¥–µ–∫—Å—ã (GiST) –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `getPointsSummary` (—Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è)
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (batch size 500)
- ‚úÖ excludeIds –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –º–∞—Å—Å–∏–≤–∞)

---

## ‚ö†Ô∏è –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

#### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç LIMIT –≤ SQL –∑–∞–ø—Ä–æ—Å–µ**
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// DeliveryPointRepository.getPointsSummary()
// –ù–ï–¢ LIMIT –≤ –∑–∞–ø—Ä–æ—Å–µ!
query += ` ORDER BY dp.city, dp.address`;
// –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 10,000+ —Ç–æ—á–µ–∫!
```

**–†–∏—Å–∫–∏:**
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º zoom out (–≤—Å—è –†–æ—Å—Å–∏—è) –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è 10,000+ —Ç–æ—á–µ–∫
- –ë–æ–ª—å—à–æ–π JSON payload (5-10 MB)
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ —Å–µ—Ç–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (supercluster –º–æ–∂–µ—Ç –Ω–µ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è)
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- **–û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö –∫–∞—Ä—Ç—ã** (–¥–∞–∂–µ —Å excludeIds –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è —Ç—ã—Å—è—á–∏ –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫)

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
query += ` ORDER BY dp.city, dp.address LIMIT 2000`;
// 2000 —Ç–æ—á–µ–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ
// supercluster –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –≥—Ä–∞–Ω–∏—Ü)

---

#### 2. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ bounds**
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// postPoints.ts - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–æ—â–∞–¥–∏ bounds
const [minLat, minLng, maxLat, maxLng] = bounds.split(',').map(parseFloat);
// –ú–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –º–∏—Ä: -90,-180,90,180
```

**–†–∏—Å–∫–∏:**
- –ú–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –æ–≥—Ä–æ–º–Ω—É—é –æ–±–ª–∞—Å—Ç—å (–≤–µ—Å—å –º–∏—Ä = 360¬∞ √ó 180¬∞)
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–æ—á–µ–∫ –∏–∑ –ë–î (–¥–µ—Å—è—Ç–∫–∏ —Ç—ã—Å—è—á)
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –ë–î –∏ —Å–µ—Ç–∏
- DDoS –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏ bounds
const maxAreaKm2 = 1000 * 1000; // 1,000,000 –∫–º¬≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ –≤—Å—è –†–æ—Å—Å–∏—è)
const area = calculateBoundsArea(minLat, minLng, maxLat, maxLng);
if (area > maxAreaKm2) {
  response.$body = {
    success: false,
    message: 'Bounds area too large. Maximum area: 1,000,000 km¬≤'
  };
  response.statusCode = 400;
  return;
}

function calculateBoundsArea(minLat: number, minLng: number, maxLat: number, maxLng: number): number {
  const latDiff = maxLat - minLat;
  const lngDiff = maxLng - minLng;
  // –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–ª–æ—â–∞–¥–∏ –≤ –∫–º¬≤
  const avgLat = (minLat + maxLat) / 2;
  const latKm = latDiff * 111; // 1¬∞ ‚âà 111 –∫–º
  const lngKm = lngDiff * 111 * Math.cos(avgLat * Math.PI / 180);
  return latKm * lngKm;
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

---

#### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç rate limiting**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—Å–µ endpoints –ø—É–±–ª–∏—á–Ω—ã–µ (`"access": "public"`)
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

**–†–∏—Å–∫–∏:**
- DDoS –∞—Ç–∞–∫–∏
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ CDEK API (–ª–∏–º–∏—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å)
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –ë–î
- –í—ã—Å–æ–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å rate limiting middleware
import rateLimit from 'express-rate-limit';

const apiLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 100, // 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ IP
  message: 'Too many requests, please try again later'
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û (–¥–ª—è production)

---

### üü° –í–ê–ñ–ù–û (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

#### 4. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ `/api/delivery/points` –∏–¥–µ—Ç –≤ –ë–î
- –¢–æ—á–∫–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–∑ –≤ –¥–µ–Ω—å)
- –ù–µ—Ç —Å–º—ã—Å–ª–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// Redis –∫—ç—à –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
const cacheKey = `delivery:points:${bounds}:${services}:${excludeIds?.join(',')}`;
const cached = await redis.get(cacheKey);
if (cached) {
  return JSON.parse(cached);
}
// ... –∑–∞–ø—Ä–æ—Å –∫ –ë–î ...
await redis.setex(cacheKey, 600, JSON.stringify(points)); // TTL 10 –º–∏–Ω—É—Ç
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û (—É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

---

#### 5. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç bounds**
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN, –Ω–æ –Ω–µ –Ω–∞ —Ä–∞–∑—É–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
if (isNaN(minLat) || isNaN(minLng) || isNaN(maxLat) || isNaN(maxLng)) {
  // ...
}
// –ù–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å: minLat=200, maxLat=-200 (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
if (minLat < -90 || minLat > 90 || maxLat < -90 || maxLat > 90) {
  response.$body = {
    success: false,
    message: 'Invalid latitude. Must be between -90 and 90'
  };
  response.statusCode = 400;
  return;
}
if (minLng < -180 || minLng > 180 || maxLng < -180 || maxLng > 180) {
  response.$body = {
    success: false,
    message: 'Invalid longitude. Must be between -180 and 180'
  };
  response.statusCode = 400;
  return;
}
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ bounds
if (minLat >= maxLat || minLng >= maxLng) {
  response.$body = {
    success: false,
    message: 'Invalid bounds. minLat must be < maxLat, minLng must be < maxLng'
  };
  response.statusCode = 400;
  return;
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û

---

#### 6. **–•–∞—Ä–¥–∫–æ–¥ –≤–µ—Å–∞ –≤ calculate –∑–∞–ø—Ä–æ—Å–µ**
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// DeliveryMapPicker.tsx:313
const totalWeight = 0.15; // TODO: –ü–æ–ª—É—á–∞—Ç—å –≤–µ—Å –∏–∑ CheckoutContext
```

**–†–∏—Å–∫–∏:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–µ–≤–µ—Ä–Ω—É—é —Ü–µ–Ω—É

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–ª—É—á–∞—Ç—å –≤–µ—Å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã/CheckoutContext
- –ò–ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û (–¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–æ–≤)

---

#### 7. ~~**–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (AbortController)**~~ ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
**–ë—ã–ª–æ:**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã—Å—Ç—Ä–æ –¥–≤–∏–≥–∞–ª –∫–∞—Ä—Ç—É, —Å—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å
- –õ–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
- Race conditions

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `AbortController` –¥–ª—è –æ—Ç–º–µ–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–∏ –Ω–æ–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å—Ç–∞—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ `AbortError` - –æ—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

---

### üü¢ –£–õ–£–ß–®–ï–ù–ò–Ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### 8. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ debug –ª–æ–≥–∏ (excludeIds validation, SQL queries)
- ‚úÖ –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ö†Ô∏è –í—Å–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ console.log (–Ω—É–∂–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (winston, pino)
- –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (debug, info, warn, error)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (JSON)
- –û—Ç–∫–ª—é—á–∞—Ç—å debug –ª–æ–≥–∏ –≤ production —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –£–õ–£–ß–®–ï–ù–ò–ï (–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è production)

---

#### 9. **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–µ –≤–∏–¥–Ω–æ, —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ù–µ—Ç –∞–ª–µ—Ä—Ç–æ–≤ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (Prometheus, DataDog)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –£–õ–£–ß–®–ï–ù–ò–ï

---

#### 10. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ 1000 —Ç–æ—á–µ–∫, –Ω–µ—Ç —Å–ø–æ—Å–æ–±–∞ –ø–æ–ª—É—á–∏—Ç—å –∏—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `limit` –∏ `offset` –∏–ª–∏ cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –£–õ–£–ß–®–ï–ù–ò–ï (–µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)

---

#### 11. **OAuth —Ç–æ–∫–µ–Ω CDEK –≤ –ø–∞–º—è—Ç–∏**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–æ–∫–µ–Ω —Ç–µ—Ä—è–µ—Ç—Å—è
- –ü—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤) –∫–∞–∂–¥—ã–π –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–π —Ç–æ–∫–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ–∫–µ–Ω –≤ Redis (–¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)
- –ò–ª–∏ –≤ –ë–î (–µ—Å–ª–∏ Redis –Ω–µ—Ç)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –£–õ–£–ß–®–ï–ù–ò–ï (–¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)

---

#### 12. **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –±–æ–ª—å—à–∏–º–∏ excludeIds –º–∞—Å—Å–∏–≤–∞–º–∏**
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ excludeIds —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ª–∏–º–∏—Ç–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `NOT (id = ANY(...))` - –Ω–∞–¥–µ–∂–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚ö†Ô∏è PostgreSQL –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ (10,000+ —ç–ª–µ–º–µ–Ω—Ç–æ–≤)

**–ù–∞–±–ª—é–¥–µ–Ω–∏—è:**
- –ü—Ä–∏ 7000+ excludeIds –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ü—Ä–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö (50,000+) –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- –ï—Å–ª–∏ –±—É–¥—É—Ç –ø—Ä–æ–±–ª–µ–º—ã, –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –±–∞—Ç—á–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ú–û–ù–ò–¢–û–†–ò–ù–ì (–ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

---

#### 13. **–ó–∞–ø—Ä–æ—Å—ã –∫ —Ç–∞–π–ª–∞–º –∫–∞—Ä—Ç—ã (tiles) –≤–µ—Å—è—Ç –º–Ω–æ–≥–æ**
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Carto basemaps (`https://basemaps.cartocdn.com/gl/positron-gl-style/style.json`)
- –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ç–∞–π–ª—ã (tiles)
- –ö–∞–∂–¥—ã–π —Ç–∞–π–ª - –æ—Ç–¥–µ–ª—å–Ω—ã–π HTTP –∑–∞–ø—Ä–æ—Å (50-200 KB)
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º zoom out –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ç–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∫–∞—Ä—Ç - —Ç–∞–π–ª—ã –Ω—É–∂–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç—è–∂–µ–ª–æ –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
- ‚ö†Ô∏è –ù–µ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞—à–∏–º API –¥–æ—Å—Ç–∞–≤–∫–∏

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–π–ª–æ–≤** - –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–µ—à–∏—Ä—É–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Service Worker
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ª–µ–≥–∫–∏–π —Å—Ç–∏–ª—å –∫–∞—Ä—Ç—ã** - –Ω–∞–ø—Ä–∏–º–µ—Ä, `positron` (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) –ª–µ–≥—á–µ —á–µ–º `dark-matter`
3. **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å zoom levels** - –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π zoom out
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä** - –Ω–∞–ø—Ä–∏–º–µ—Ä, OpenStreetMap (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ)
5. **Lazy loading —Ç–∞–π–ª–æ–≤** - –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —Ç–∞–π–ª—ã (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ react-map-gl)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç
- –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Service Worker –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–π–ª–æ–≤
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ª–µ–≥–∫–∏–π —Å—Ç–∏–ª—å –∫–∞—Ä—Ç—ã

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ò–ù–§–û–†–ú–ê–¶–ò–Ø (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å)

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
- –•–æ—Ä–æ—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ
- PostGIS –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **excludeIds —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —ç–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. ‚ùå –ù–µ—Ç LIMIT –≤ SQL –∑–∞–ø—Ä–æ—Å–µ (–º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 10,000+ —Ç–æ—á–µ–∫)
2. ‚ùå –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ bounds (–º–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –º–∏—Ä)
3. ‚ùå –ù–µ—Ç rate limiting (DDoS –≤–µ–∫—Ç–æ—Ä)
4. ‚ùå –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

**–°—Ä–æ—á–Ω–æ (–ø–µ—Ä–µ–¥ production):**
1. ‚úÖ ~~excludeIds –±–µ–∑ –ª–∏–º–∏—Ç–∞~~ - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
2. üî¥ –î–æ–±–∞–≤–∏—Ç—å LIMIT –≤ `getPointsSummary` (2000 —Ç–æ—á–µ–∫) - **–ö–†–ò–¢–ò–ß–ù–û**
3. üî¥ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ bounds (–º–∞–∫—Å–∏–º—É–º 1,000,000 –∫–º¬≤) - **–ö–†–ò–¢–ò–ß–ù–û**
4. üî¥ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç bounds - **–ö–†–ò–¢–ò–ß–ù–û**
5. üî¥ –î–æ–±–∞–≤–∏—Ç—å rate limiting - **–ö–†–ò–¢–ò–ß–ù–û –¥–ª—è production**

**–í–∞–∂–Ω–æ (–≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):**
6. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ (Redis) - —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
7. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Å–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤

**–£–ª—É—á—à–µ–Ω–∏—è (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≤—Ä–µ–º—è):**
9. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (winston/pino)
10. –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus)
11. OAuth —Ç–æ–∫–µ–Ω –≤ Redis (–¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è)

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –Ω–æ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è production**

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ
- ‚úÖ excludeIds —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —ç–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫
- ‚úÖ –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —á–∏—Å—Ç–∞—è
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ production:**
- üî¥ LIMIT –≤ SQL (2000 —Ç–æ—á–µ–∫) - **–ö–†–ò–¢–ò–ß–ù–û**
- üî¥ –í–∞–ª–∏–¥–∞—Ü–∏—è bounds (—Ä–∞–∑–º–µ—Ä –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã) - **–ö–†–ò–¢–ò–ß–ù–û**
- üî¥ Rate limiting - **–ö–†–ò–¢–ò–ß–ù–û**

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ excludeIds —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (—ç–∫–æ–Ω–æ–º–∏—è 70-90% —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö)
- ‚ö†Ô∏è –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö –∫–∞—Ä—Ç—ã –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫ (–Ω—É–∂–µ–Ω LIMIT)
- ‚ö†Ô∏è –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π (–Ω—É–∂–µ–Ω rate limiting)

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –∫ production! üöÄ
